# Stroke Detection AI ‚Äî ResNet18 Classifier for Brain CT Scans

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è, –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (ResNet18),  
—Å–ø–æ—Å–æ–±–Ω–æ–π **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ö–¢-—Å–Ω–∏–º–∫–∏ –º–æ–∑–≥–∞** –Ω–∞ –¥–≤–∞ –∫–ª–∞—Å—Å–∞:
- **Normal** ‚Äî –Ω–æ—Ä–º–∞  
- **Stroke** ‚Äî –∏–Ω—Å—É–ª—å—Ç  

–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ PyTorch –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ transfer learning –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

---

## üß© –û–ø–∏—Å–∞–Ω–∏–µ

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, —Å–ø–æ—Å–æ–±–Ω–æ–π –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –∏–Ω—Å—É–ª—å—Ç–∞ –ø–æ –¥–∞–Ω–Ω—ã–º –ö–¢-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≥–æ–ª–æ–≤–Ω–æ–≥–æ –º–æ–∑–≥–∞.  
–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç:

- –ü–æ–¥–≥–æ—Ç–æ–≤–∫—É –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –¥–∞—Ç–∞—Å–µ—Ç–∞ (`Normal` / `Stroke`)
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ `Dataset` –Ω–∞ PyTorch
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (resize, normalize)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã **ResNet18** —Å –¥–æ–æ–±—É—á–µ–Ω–∏–µ–º (`fine-tuning`)
- –í–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫—É –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –º–µ—Ç—Ä–∏–∫ —á–µ—Ä–µ–∑ confusion matrix

---

## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ú–æ–¥–µ–ª—å –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ **ResNet18**, –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –Ω–∞ ImageNet.  
–§–∏–Ω–∞–ª—å–Ω—ã–π —Å–ª–æ–π –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ –æ–¥–∏–Ω –≤—ã—Ö–æ–¥–Ω–æ–π –Ω–µ–π—Ä–æ–Ω (–±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è):

ResNet18 ‚Üí Fully Connected (in_features ‚Üí 1)


–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å ‚Äî `BCEWithLogitsLoss`  
–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä ‚Äî `Adam`  
–ú–µ—Ç—Ä–∏–∫–∞ ‚Äî –±–∏–Ω–∞—Ä–Ω–∞—è –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏—è (—á–µ—Ä–µ–∑ loss)

---

## üß± –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/yourusername/stroke-detection-ai.git
cd stroke-detection-ai
python -m venv venv
source venv/bin/activate      # (–∏–ª–∏ venv\Scripts\activate –≤ Windows)
pip install torch torchvision scikit-learn pillow tqdm matplotlib numpy
```

---

## üß¨ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–µ–π:
```
Brain_Data_Organised/
‚îÇ
‚îú‚îÄ‚îÄ Normal/
‚îÇ   ‚îú‚îÄ‚îÄ image_001.jpg
‚îÇ   ‚îú‚îÄ‚îÄ image_002.jpg
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ Stroke/
    ‚îú‚îÄ‚îÄ stroke_001.jpg
    ‚îú‚îÄ‚îÄ stroke_002.jpg
    ‚îî‚îÄ‚îÄ ...
```

–£–∫–∞–∂–∏—Ç–µ –ø—É—Ç–∏ –≤ –Ω–∞—á–∞–ª–µ –Ω–æ—É—Ç–±—É–∫–∞:
```
NORMAL_DIR = '/Brain_Data_Organised/Normal'
STROKE_DIR = '/Brain_Data_Organised/Stroke'
```

---

### üîç –ò–Ω—Ñ–µ—Ä–µ–Ω—Å (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ)

–î–ª—è —Ç–µ—Å—Ç–∞ –Ω–∞ –Ω–æ–≤–æ–º —Å–Ω–∏–º–∫–µ:
```
MODEL_PATH = 'stroke_classifier_resnet18.pth'
IMG_PATH = '/path/to/ct_image.jpg'
```

–ú–æ–¥–µ–ª—å –≤—ã–¥–∞—ë—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏–Ω—Å—É–ª—å—Ç–∞ –∏ –¥–∏–∞–≥–Ω–æ–∑:
```
–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏–Ω—Å—É–ª—å—Ç–∞: 0.9341 ‚Üí –ò–Ω—Å—É–ª—å—Ç
```

---

### üìä –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏

–í –ø—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–µ–Ω–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è Confusion Matrix –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ:
```
from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay
disp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=["Normal", "Stroke"])
disp.plot(cmap=plt.cm.Blues)
plt.title("–ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ (Confusion Matrix)")
plt.show()
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
True Positives / False Positives / True Negatives / False Negatives
```

---

### üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: ResNet18
- –°—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ‚âà 93%
- –ü–æ—Ç–µ—Ä–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ < 0.3 –ø–æ—Å–ª–µ 10 —ç–ø–æ—Ö
- –ü—Ä–∏–º–µ–Ω—ë–Ω Transfer Learning –∏ Fine-tuning –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ (–æ–∫–æ–ª–æ 2500 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

---

### üíæ –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
```
main_ai.ipynb              # –û—Å–Ω–æ–≤–Ω–æ–π –Ω–æ—É—Ç–±—É–∫ —Å –∫–æ–¥–æ–º –æ–±—É—á–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
stroke_classifier_resnet18.pth   # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
README.md                  # –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```
